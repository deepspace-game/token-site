<html>
<head>
<title>DeepSpace Stats Client Test</title>
<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
	let xhr = new XMLHttpRequest();
	xhr.open('GET', "https://token.deepspace.game/api");
	xhr.send();

	var respond;
	var tokenName = "";
	var tokenSymbol = "";
	var totalBurned = "";
	var launchDate = "";
	//var price ="";
	var holders = "";
	var totalSupply = "";
	//var marketCap = "";
	var followers = "";
	var maximumSupply = "";
	var circulatingSupply = "";
	//var volume = "";
	var totalTransactions = "";
	var divisor = "";
	var shortDesc = "";
	var longDesc = "";
	var lastUpdated = "";
	var logoList = "";
	var excludeCirculatingSupplyList = "";
	var burnAddress = "";

	largeFormat = d3.format(",.0f");
	largeFormatDecimal = d3.format(",.2f");
	
	xhr.onreadystatechange = function() {
		if (xhr.readyState === 4) {
		  var data = xhr.response;
		  tokenData = JSON.parse(data);
		  console.log(tokenData);
			
		  tokenName = tokenData["name"];
		  document.getElementById('name').innerHTML = "Token Name: " + tokenName;
			
		  tokenSymbol = tokenData["symbol"];
		  document.getElementById('symbol').innerHTML = "Token Symbol: " + tokenSymbol;
			
		  launchDate = tokenData["launch_date"];
		  document.getElementById('launchDate').innerHTML = "Launch Date: " + launchDate;
			
		  totalBurned = tokenData["burned"];
		  document.getElementById('burned').innerHTML = "Total Burned: " + largeFormat(totalBurned);
			
		  //tokenPrice = tokenData["price"];
		  //document.getElementById('price').innerHTML = "Price: $" + tokenPrice;
			
		  holders = tokenData["holders"];
		  document.getElementById('holders').innerHTML = "Holders: " + largeFormat(holders);
		  
		  //marketCap = tokenData["marketCap"];
		  //document.getElementById('marketCap').innerHTML = "Market Cap: $" + largeFormatDecimal(marketCap);
			
		  totalSupply = tokenData["total_supply"];
		  document.getElementById('totalSupply').innerHTML = "Total Supply: " + largeFormat(totalSupply);
			
		  followers = tokenData["social_score"];
		  document.getElementById('followers').innerHTML = "Followers: " + largeFormat(followers);
			
		  maximumSupply = tokenData["maximum_supply"];
		  document.getElementById('maximumSupply').innerHTML = "Maximum Supply: " + largeFormat(maximumSupply);
			
		  circulatingSupply = tokenData["circulating_supply"];
		  document.getElementById('circulatingSupply').innerHTML = "Circulating Supply: " + largeFormat(circulatingSupply);
			
		  //volume = tokenData["volume"];
		  //document.getElementById('volume').innerHTML = "Total Volume: $" + largeFormatDecimal(volume);
			
		  totalTransactions = tokenData["total_transactions"];
		  document.getElementById('totalTransactions').innerHTML = "Total Transactions: " + largeFormat(totalTransactions);
			
		  divisor = tokenData["divisor"];
		  document.getElementById('divisor').innerHTML = "Divisor: " + divisor;
			
		  shortDesc = tokenData["short_description"];
		  document.getElementById('shortDesc').innerHTML = "Short Description:<br>" + shortDesc;
			
		  longDesc = tokenData["long_description"];
		  document.getElementById('longDesc').innerHTML = "Long Description:<br>" + longDesc.replace(/\n/g, "<br>");

		  logoList = tokenData["logo_list"];
		  document.getElementById('logoList').innerHTML = "Logo List:<br>";

		  for (let i = 0; i < logoList.length; i++) {
		  	logoSize = logoList[i]["logo_size"];
		  	logoUrl = logoList[i]["logo_url"];
			  
		  	document.getElementById('logoList').innerHTML += "<a href=\"" + logoUrl + "\"><img src=\"" + logoUrl + "\" alt=\"" + tokenName + " - " + logoSize + " size logo\" />(" + logoSize + ")</a><br>";
		  }
		
		  excludeCirculatingSupplyList = tokenData["exclude_circulating_supply"];
		  document.getElementById('excludeCirculatingSupply').innerHTML = "Exclude Circulating Supply List:<br><br>";

		  for (let i = 0; i < excludeCirculatingSupplyList.length; i++) {
		  	excludeAddress = excludeCirculatingSupplyList[i]["address"];
		  	excludeTag = excludeCirculatingSupplyList[i]["tag"];
			excludeBalance = excludeCirculatingSupplyList[i]["balance"];
			  
		  	document.getElementById('excludeCirculatingSupply').innerHTML += "Exclude Address: " + excludeAddress + "<br>";
			document.getElementById('excludeCirculatingSupply').innerHTML += "Exclude Tag: " + excludeTag + "<br>";
			document.getElementById('excludeCirculatingSupply').innerHTML += "Exclude Balance: " + excludeBalance + "<br><br>";
		  }
			
		  burnAddress = tokenData["burn_address"];
		  document.getElementById('burnAddress').innerHTML = "Burn Address: " + burnAddress;
			
		  lastUpdated = tokenData["last_updated"];
		  document.getElementById('lastUpdated').innerHTML = "Last Updated: " + lastUpdated;

		}
	}
</script>
</head>
<body>
<h1>DeepSpace Stats Client Test</h1>
<p><i>Tip: Check the console log for the full JSON response from the token stat server</i></p>
<p>Pro Tip: Command Supported: <a href="https://token.deepspace.game/api?q=totalsupply">https://token.deepspace.game/api?q=totalsupply</a></p>
<p>Pro Tip: API Endpoint: <a href="https://token.deepspace.game/api">https://token.deepspace.game/api</a></p>
<br><div id="name">Token Name: N/A</div>
<br><div id="symbol">Token Symbol: N/A</div>
<br><div id="divisor">Divisor: N/A</div>
<br><div id="burned">Total Burned: N/A</div>
<!-- <br><div id="price">Price: N/A</div> -->
<br><div id="holders">Holders: N/A</div>
<!-- <br><div id="marketCap">Market Cap: N/A</div> -->
<br><div id="totalSupply">Total Supply: N/A</div>
<br><div id="followers">Followers: N/A</div>
<br><div id="maximumSupply">Maximum Supply: N/A</div>
<br><div id="circulatingSupply">Circulating Supply: N/A</div>
<!-- <br><div id="volume">Total Volume: N/A</div> -->
<br><div id="totalTransactions">Total Transactions: N/A</div>
<br><div id="launchDate">Launch Date: N/A</div>
<br><div id="shortDesc">Short Description: N/A</div>
<br><div id="longDesc">Long Description: N/A</div>
<br>
<br><div id="logoList">Logo List - N/A</div>
<br>
<br><div id="excludeCirculatingSupply">Exclude Circulating Supply List - N/A</div>
<br><div id="burnAddress">Burn Address: N/A</div>
<br>
<br><div id="lastUpdated">Last Updated: N/A</div>
</body>
</html>
